var MAXSEEDS=48,NUM_HOUSES=6,SowDirType;!function(a){a[a.RtoL=0]="RtoL",a[a.LtoR=1]="LtoR"}(SowDirType||(SowDirType={}));var gameLogic;!function(a){function b(){var a={store:0,house:[4,4,4,4,4,4],sowDir:SowDirType.RtoL},b={store:0,house:[4,4,4,4,4,4],sowDir:SowDirType.LtoR},c={boardSides:[b,a]};return c}function c(a){return 0===a.house.reduce(function(a,b){return a+b})}function d(a){return a.house.reduce(function(a,b){return a+b})+a.store}function e(a){return c(a.boardSides[0])||c(a.boardSides[1])?d(a.boardSides[0])===Math.floor(MAXSEEDS/2):!1}function f(a){return c(a.boardSides[0])||c(a.boardSides[1])?d(a.boardSides[0])>Math.floor(MAXSEEDS/2)?a.boardSides[0]:a.boardSides[1]:null}function g(a,c,d){if(a||(a=b()),e(a)||null!==f(a))throw new Error("Can only make a move if the game is not over!");if(0===c.nitems)throw new Error("Sowing zero seeds?");var g=angular.copy(c),h=angular.copy(a),i=d,j=(g.nitems,a.boardSides[d].sowDir);h.boardSides[d].house[g.house]=0;for(var k={sowDir:void 0,houseNum:void 0,store:!1},l=g.house+1;g.nitems>0;){k.sowDir=h.boardSides[d].sowDir===SowDirType.RtoL?SowDirType.RtoL:SowDirType.LtoR;for(var m=l;NUM_HOUSES>m&&(h.boardSides[d].house[m]++,g.nitems--,k.houseNum=m,k.store=!1,0!==g.nitems);m++);g.nitems>0&&i===d&&(h.boardSides[d].store++,k.houseNum=NUM_HOUSES,k.store=!0,g.nitems--),d=1-d,l=0}k.store||k.sowDir!==j||1!==h.boardSides[i].house[k.houseNum]||h.boardSides[1-i].house[NUM_HOUSES-1-k.houseNum]>0&&(h.boardSides[i].store+=h.boardSides[1-i].house[NUM_HOUSES-1-k.houseNum]+1,h.boardSides[i].house[k.houseNum]=0,h.boardSides[1-i].house[NUM_HOUSES-1-k.houseNum]=0);var n,o=f(h);n=e(h)?{endMatch:{endMatchScores:[0,0]}}:null!==o?{endMatch:{endMatchScores:o.sowDir===SowDirType.LtoR?[1,0]:[0,1]}}:k.store?{setTurn:{turnIndex:i}}:{setTurn:{turnIndex:1-i}};var p=angular.copy(c);return[n,{set:{key:"board",value:h}},{set:{key:"delta",value:p}}]}function h(a){var b=a.move,c=a.turnIndexBeforeMove,d=a.stateBeforeMove;try{var e=b[2].set.value,f=angular.copy(e),h=d.board,i=g(h,f,c);if(!angular.equals(b,i))return!1}catch(j){return!1}return!0}a.getInitialBoard=b,a.createMove=g,a.isMoveOk=h}(gameLogic||(gameLogic={}));var game;!function(a){function b(){console.log("Translation of 'RULES_OF_KALAH' is "+translate("RULES_OF_KALAH")),resizeGameAreaService.setWidthToHeight(1.67),gameService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:gameLogic.isMoveOk,updateUI:e}),document.addEventListener("animationend",c,!1),document.addEventListener("webkitAnimationEnd",c,!1),document.addEventListener("oanimationend",c,!1)}function c(){$rootScope.$apply(function(){log.info("Animation ended"),t=!0,v&&d()})}function d(){v&&(v=!1,$timeout(function(){gameService.makeMove(aiService.createComputerMove(w.board,y,{millisecondsLimit:1e3}))},500))}function e(a){t=!1,w=a.stateAfterMove,x=a.stateBeforeMove,w.board||(w.board=gameLogic.getInitialBoard()),u=a.turnIndexAfterMove>=0&&a.yourPlayerIndex===a.turnIndexAfterMove,y=a.turnIndexAfterMove,console.log("upd ui: "+JSON.stringify(a)),v=u&&""===a.playersInfo[a.yourPlayerIndex].playerId,v&&(u=!1,console.log(""+JSON.stringify(w)),d()),A=u&&"passAndPlay"===a.playMode,A=A||u&&1===a.playMode,A=A&&1===a.yourPlayerIndex,console.log("flip: "+A)}function f(){return A}function g(a){return w.board.boardSides[a].store}function h(a){for(var b=[],c=g(a),d=1;c>=d;d++)b.push(d);return b}function i(a,b){return f()?(0===a&&(b=NUM_HOUSES-1-b),w.board.boardSides[a].house[b]):(1===a&&(b=NUM_HOUSES-1-b),w.board.boardSides[a].house[b])}function j(a,b){for(var c=[],d=i(a,b),e=1;d>=e;e++)c.push(e);return c}function k(a){var b=B[a].t,c=B[a].l;return C.top=b+"%",C.left=c+"%",C}function l(a){var b=D[a].t,c=D[a].l;return E.top=b+"%",E.left=c+"%",E}function m(a,b,c){var d=2*b+c+1;return w.board.boardSides[a].store>=d?!0:!1}function n(){for(var a=[],b=0;MAXSEEDS/2>b;b++)a[b]=b;return a}function o(){for(var a=[],b=0;NUM_HOUSES>b;b++)a[b]=b;return a}function p(){for(var a=[],b=0;z>b;b++)a[b]=b;return a}function q(a,b){if(u&&y==a){f()?0===a&&(b=NUM_HOUSES-1-b):1===a&&(b=NUM_HOUSES-1-b);var c=w.board.boardSides[a].house[b];if(0!==c){var d={boardSideId:a,house:b,nitems:c};try{var e=gameLogic.createMove(w.board,d,y);u=!1,gameService.makeMove(e)}catch(g){return void log.info(["Invalid move:",a,b])}}}}function r(a,b,c){if(!w)return!1;if(!x)return!1;if(!x.board)return!1;var d=c;f()?0===a&&(d=NUM_HOUSES-1-d):1===a&&(d=NUM_HOUSES-1-d);var e=x.board.boardSides[a].store,g=w.board.boardSides[a].store;if(e>=g)return!1;var h=2*b+c+1;return h>e?!0:!1}function s(a){if(!w)return!1;if(!x)return!1;if(!x.board)return!1;var b=x.board.boardSides[a].store,c=w.board.boardSides[a].store;return c!==b}var t=!1,u=!1,v=!1,w=null,x=null,y=null;a.isHelpModalShown=!1;var z=8,A=!1;a.init=b,a.shouldFlipDisplay=f,a.getStoreCount=g,a.getStoreCountAsArray=h,a.getHouseSeedCount=i,a.getHouseSeedCountAsArray=j;var B=[{t:51,l:52},{t:49,l:23},{t:53,l:44},{t:57,l:35},{t:45,l:37},{t:35,l:80},{t:58,l:66},{t:72,l:16},{t:78,l:19},{t:83,l:36},{t:65,l:47},{t:64,l:45},{t:23,l:72},{t:43,l:75},{t:56,l:72},{t:89,l:43},{t:84,l:37},{t:77,l:23},{t:62,l:13},{t:11,l:19},{t:83,l:25},{t:53,l:27},{t:44,l:37},{t:37,l:32},{t:17,l:41},{t:56,l:42},{t:62,l:48},{t:56,l:49},{t:51,l:58},{t:27,l:56},{t:29,l:14},{t:27,l:62},{t:28,l:67},{t:35,l:2},{t:42,l:8},{t:44,l:8},{t:43,l:72},{t:67,l:67},{t:56,l:13},{t:55,l:31},{t:67,l:14},{t:66,l:19},{t:62,l:27},{t:73,l:42},{t:74,l:35},{t:81,l:3},{t:89,l:38},{t:12,l:76}],C={position:"absolute",width:"20%",height:"10%",top:"%",left:"%"};a.getStoreSeedStyle=k;var D=[{t:51,l:52},{t:49,l:23},{t:53,l:44},{t:57,l:35},{t:45,l:37},{t:35,l:80},{t:58,l:66},{t:62,l:16},{t:68,l:19},{t:23,l:36},{t:65,l:47},{t:64,l:45},{t:23,l:72},{t:43,l:75},{t:56,l:72},{t:19,l:43},{t:44,l:37},{t:77,l:23},{t:62,l:13},{t:11,l:19},{t:33,l:25},{t:53,l:27},{t:44,l:37},{t:37,l:32},{t:17,l:41}],E={position:"absolute",width:"20%",height:"20%",top:"%",left:"%"};a.getHouseSeedStyle=l,a.isKalahInStore=m,a.getStoreDisplayRowArray=n,a.getHouseArray=o,a.getHouseRowArray=p,a.houseClicked=q,a.shouldSlowlyAppearInStore=r,a.shouldSlowlyAppearStoreCount=s}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).run(function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_KALAH:"Rules of Kalah",RULES_SLIDE1:"Players take turns to sow the seeds anti-clockwise.",RULES_SLIDE2:"The one to collect more than 24 seeds in their store wins.",CLOSE:"Close"}),game.init()});var aiService;!function(a){function b(a,b,e){return alphaBetaService.alphaBetaDecision([null,{set:{key:"board",value:a}}],b,d,c,null,e)}function c(a){if(a[0].endMatch){var b=a[0].endMatch.endMatchScores;return b[0]>b[1]?Number.POSITIVE_INFINITY:b[0]<b[1]?Number.NEGATIVE_INFINITY:0}return 0}function d(b,c){return a.getPossibleMoves(b[1].set.value,c)}function e(a,b){for(var c=[],d=0;NUM_HOUSES>d;d++)try{if(0!==a.boardSides[b].house[d]){var e={boardSideId:b,house:d,nitems:a.boardSides[b].house[d]};c.push(gameLogic.createMove(a,e,b))}}catch(f){}return c}a.createComputerMove=b,a.getPossibleMoves=e}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map